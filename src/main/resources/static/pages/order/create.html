<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>创建订单 - 订单管理系统</title>
    <link rel="stylesheet" href="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.6.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/main.css">
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand" href="/">订单管理系统</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/order/list.html">我的订单</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/product/list.html">商品列表</a>
                    </li>
                    <li class="nav-item active">
                        <a class="nav-link" href="/pages/order/create.html">创建订单</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/pages/syslog/console.html">系统日志</a>
                    </li>
                </ul>
                <ul class="navbar-nav">
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="userDropdown" role="button" data-toggle="dropdown">
                            <img id="nav-avatar" src="/images/default-avatar.jpg" alt="用户头像" class="rounded-circle mr-1" style="width: 25px; height: 25px; object-fit: cover;">
                            <span id="current-username">用户未登录</span>
                        </a>
                        <div class="dropdown-menu dropdown-menu-right">
                            <a class="dropdown-item" href="/pages/user/profile.html">个人中心</a>
                            <div class="dropdown-divider"></div>
                            <a class="dropdown-item" href="#" id="logout-btn">退出登录</a>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container order-container">
        <div class="order-header">
            <h2>创建新订单</h2>
            <a href="/pages/order/list.html" class="btn btn-secondary">返回订单列表</a>
        </div>
        
        <div class="alert alert-success" id="success-message" style="display: none;"></div>
        <div class="alert alert-danger" id="error-message" style="display: none;"></div>
        
        <div class="row">
            <div class="col-md-8">
                <h4 class="mb-3">选择商品</h4>
                
                <div id="products-container">
                    <!-- 商品列表将通过JavaScript动态加载 -->
                    <div class="text-center">
                        <div class="spinner-border" role="status">
                            <span class="sr-only">加载中...</span>
                        </div>
                        <p>正在加载商品数据...</p>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="cart-summary">
                    <h4 class="mb-3">订单信息</h4>
                    <form id="order-form">
                        <div class="form-group">
                            <label for="receiver">收货人</label>
                            <input type="text" class="form-control" id="receiver" name="receiver" required>
                        </div>
                        <div class="form-group">
                            <label for="receiverPhone">联系电话</label>
                            <input type="tel" class="form-control" id="receiverPhone" name="receiverPhone" required>
                        </div>
                        <div class="form-group">
                            <label for="address">收货地址</label>
                            <textarea class="form-control" id="address" name="address" rows="3" required></textarea>
                        </div>
                        <div class="form-group">
                            <label for="remark">订单备注</label>
                            <textarea class="form-control" id="remark" name="remark" rows="2"></textarea>
                        </div>
                        
                        <hr class="mb-4">
                        <div class="d-flex justify-content-between mb-3">
                            <span>商品总数：</span>
                            <span id="total-quantity">0</span>
                        </div>
                        <div class="d-flex justify-content-between mb-3">
                            <span>订单总金额：</span>
                            <span id="total-amount" class="font-weight-bold">¥0.00</span>
                        </div>
                        
                        <button class="btn btn-primary btn-lg btn-block" type="submit" id="submit-btn" disabled>提交订单</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- 商品项模板 -->
    <template id="product-item-template">
        <div class="product-item" data-id="">
            <div class="row">
                <div class="col-md-8">
                    <h5 class="product-name"></h5>
                    <p class="text-muted product-desc"></p>
                    <p class="product-price"></p>
                    <p class="text-muted">库存: <span class="product-stock"></span></p>
                </div>
                <div class="col-md-4 text-right">
                    <div class="form-group">
                        <label for="quantity">数量</label>
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <button class="btn btn-outline-secondary decrease-btn" type="button">-</button>
                            </div>
                            <input type="number" class="form-control text-center quantity-input" value="0" min="0" max="100">
                            <div class="input-group-append">
                                <button class="btn btn-outline-secondary increase-btn" type="button">+</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </template>

    <script src="https://cdn.bootcdn.net/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/popper.js/1.16.1/umd/popper.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/twitter-bootstrap/4.6.0/js/bootstrap.min.js"></script>
    <script src="/js/main.js"></script>
    <script src="/js/order/create.js"></script>
</body>
</html>